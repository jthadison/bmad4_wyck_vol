# =============================================================================
# BMAD Wyckoff Trading System - Environment Configuration
# =============================================================================
# Copy this file to .env and update with your values.
# See docs/architecture/configuration.md for full documentation.
#
# IMPORTANT: Never commit .env files with real credentials to version control.

# =============================================================================
# Environment & Debug
# =============================================================================
ENVIRONMENT=development
DEBUG=true

# =============================================================================
# Database Configuration
# =============================================================================
DATABASE_URL=postgresql+psycopg://wyckoff_user:changeme@localhost:5432/wyckoff_db
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=10
DB_POOL_PRE_PING=true
DB_POOL_RECYCLE=3600
DB_ECHO=false
ENABLE_QUERY_LOGGING=false
BAR_BATCH_SIZE=1000

# =============================================================================
# Redis Configuration
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_URL=redis://localhost:6379/0
ENABLE_BAR_CACHE=false
BAR_CACHE_TTL=60

# =============================================================================
# Market Data Providers
# =============================================================================
# Polygon.io: https://polygon.io/dashboard/api-keys
POLYGON_API_KEY=your_polygon_api_key_here

# Alpaca Markets (market data): https://app.alpaca.markets
ALPACA_API_KEY=
ALPACA_SECRET_KEY=

# Twelve Data API (Story 21.1): https://twelvedata.com/account
TWELVEDATA_API_KEY=your_twelvedata_api_key_here
TWELVEDATA_BASE_URL=https://api.twelvedata.com
TWELVEDATA_RATE_LIMIT=8
TWELVEDATA_TIMEOUT=10

# =============================================================================
# Data Ingestion Settings
# =============================================================================
DEFAULT_PROVIDER=polygon
RATE_LIMIT_DELAY=1.0
MAX_RETRIES=3
BATCH_SIZE=500

# =============================================================================
# Application Settings
# =============================================================================
BACKEND_PORT=8000
APP_BASE_URL=http://localhost:5173

# =============================================================================
# Real-Time Data Feed
# =============================================================================
# Comma-separated list of symbols for real-time streaming
WATCHLIST_SYMBOLS=["AAPL","TSLA","SPY"]
BAR_TIMEFRAME=1m

# =============================================================================
# Real-Time Pattern Scanner (Story 19.1)
# =============================================================================
SCANNER_QUEUE_MAX_SIZE=1000
SCANNER_PROCESSING_TIMEOUT_MS=100
SCANNER_CIRCUIT_BREAKER_THRESHOLD=5
SCANNER_CIRCUIT_BREAKER_RESET_SECONDS=30

# =============================================================================
# Stale Data Protection (Story 19.26)
# =============================================================================
STALENESS_THRESHOLD_SECONDS=300
STALENESS_ALERT_THRESHOLD_SECONDS=900

# =============================================================================
# Orchestrator Configuration (ORCHESTRATOR_ prefix)
# =============================================================================
# These use the ORCHESTRATOR_ prefix and are managed by OrchestratorConfig.
# See src/orchestrator/config.py for all options.
ORCHESTRATOR_DEFAULT_LOOKBACK_BARS=500
ORCHESTRATOR_MAX_CONCURRENT_SYMBOLS=10
ORCHESTRATOR_CACHE_TTL_SECONDS=300
ORCHESTRATOR_CACHE_MAX_SIZE=1000
ORCHESTRATOR_ENABLE_PARALLEL_PROCESSING=true
ORCHESTRATOR_ENABLE_CACHING=true
ORCHESTRATOR_MAX_DETECTOR_RETRIES=3
ORCHESTRATOR_CIRCUIT_BREAKER_THRESHOLD=5
ORCHESTRATOR_CIRCUIT_BREAKER_RESET_SECONDS=60
ORCHESTRATOR_DETECTOR_MODE=production
ORCHESTRATOR_MIN_RANGE_QUALITY_SCORE=60
ORCHESTRATOR_MIN_PHASE_CONFIDENCE=70
ORCHESTRATOR_TARGET_PER_SYMBOL_MS=500
ORCHESTRATOR_TARGET_TOTAL_MS=5000

# =============================================================================
# Forex Configuration
# =============================================================================
FOREX_VOLUME_SOURCE=TICK

# =============================================================================
# Market Regime Detection (Story 16.7a)
# =============================================================================
# WARNING: These are trading methodology parameters. Changing them affects
# signal detection and MUST be backtested before production use.
# Override only for emergency situations (market crash, extreme volatility).
REGIME_ADX_THRESHOLD=25.0
REGIME_HIGH_VOL_MULTIPLIER=1.5
REGIME_LOW_VOL_MULTIPLIER=0.5

# =============================================================================
# JWT Authentication (Story 11.7)
# =============================================================================
# CRITICAL: Change JWT_SECRET_KEY in production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=dev-secret-key-change-in-production-use-64-char-random-string
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# CORS Configuration (Story 23.12)
# =============================================================================
# Use specific origins in production, e.g.: ["https://your-domain.com"]
CORS_ORIGINS=["*"]

# =============================================================================
# Risk Management
# =============================================================================
RISK_ALLOCATION_CONFIG_PATH=config/risk_allocation.yaml
ACCOUNT_EQUITY=100000

# =============================================================================
# Daily P&L and Alerting (Story 23.13)
# =============================================================================
DAILY_PNL_LIMIT_PCT=-3.0
SLACK_WEBHOOK_URL=
ALERT_RATE_LIMIT_SECONDS=60
KILL_SWITCH_AUTO_TRIGGER_ENABLED=true

# =============================================================================
# Broker Configuration (Story 23.7)
# =============================================================================
AUTO_EXECUTE_ORDERS=false
# Safety gate: AUTO_EXECUTE_ORDERS requires PAPER_TRADING_VALIDATED=true
# This prevents accidental live trading during paper trading phase.
# Only set to true after explicitly validating broker configuration.
PAPER_TRADING_VALIDATED=false

# MetaTrader 5 (Story 23.4)
MT5_ACCOUNT=
MT5_PASSWORD=
MT5_SERVER=

# Alpaca Trading (Story 23.5) - separate from market data keys
ALPACA_TRADING_API_KEY=
ALPACA_TRADING_SECRET_KEY=
ALPACA_TRADING_PAPER=true

# TradingView Webhook
TRADINGVIEW_WEBHOOK_SECRET=

# =============================================================================
# News API (FR29 - News Blackout Enforcement)
# =============================================================================
# Required for news blackout enforcement (FR29). Without this, signals
# can be generated during earnings/high-impact news events (FOMC, NFP, etc.).
# Get your key at: https://newsapi.org
NEWS_API_KEY=

# =============================================================================
# Email Notifications (Story 19.25)
# =============================================================================
EMAIL_PROVIDER=smtp
EMAIL_FROM_ADDRESS=alerts@bmad-trading.com
EMAIL_FROM_NAME=BMAD Trading Alerts
EMAIL_RATE_LIMIT_PER_HOUR=10
SENDGRID_API_KEY=
